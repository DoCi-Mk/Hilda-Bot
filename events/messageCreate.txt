//Important: See The Video How I Edit All Commands
const client = require('../index.js')
const { MessageActionRow, MessageEmbed, MessageButton, MessageSelectMenu } = require('discord.js')
const config = require('../config.json')
const { Permissions } = require('discord.js')
const prefixdb = require('../models/prefix')
const premiumSchema = require('../models/premium.js')
const emoji = require('../emoji')
LOG_CHANNEL = '904827498548850698'


client.on('messageCreate', async message => {
  if (message.author.bot && (!message.channel.id === '886691835752370186' || !message.channel.id === 903761113177530398)) return;

  if ((!message.guild.me.permissions.has(Permissions.FLAGS.SEND_MESSAGES, Permissions.FLAGS.EMBED_LINKS) || !message.guild.me.permissionsIn(message.channel).has(Permissions.FLAGS.SEND_MESSAGES, Permissions.FLAGS.EMBED_LINKS))) return
  if (message.author.bot) return;
  if (!message.guild) return;
  let prefix = await prefixdb.findOne({
    guildid: message.guild.id
  }).exec();
  if (prefix == null) {
    prefix = config.prefix
  } else {
    prefix = prefix.prefix;
  }
  if (!message.content.startsWith(prefix)) return;
  if (!message.member) message.member = await message.guild.fetchMember(message);
  const args = message.content.slice(prefix.length).trim().split(/ +/g);
  const cmd = args.shift().toLowerCase();
  if (cmd.length == 0) return;
  let command = client.commands.get(cmd)
  if (!command) command = client.commands.get(client.aliases.get(cmd));


  if (command) {
    const messageRow = new MessageActionRow()
      .addComponents(
        new MessageButton()
          .setEmoji(emoji.invite)
          .setLabel(`Invite Again`)
          .setStyle("LINK")
          .setURL(config.onlynudes.inviteLink)
      )
    const messageEmbed = new MessageEmbed()
      .setTitle(`Please use this command as a Slash Command!`)
      .setColor(config.color.pink)
      .setDescription(`
      This command can only be used as a Slash Command. Please use \`/help\` instead to execute this command. Non-slash commands will be disappearing as of **August 2022** .
Please note that **all bots** will be **required to** switch to Slash Commands by **August 2022**, so you better be getting used to them now!
If the server you are in is not showing **__OnlyNudes__** slash commands you can ask an administrator of the server to invite the bot again by clicking on the **button** below . The bot **doesn't need to be kicked**, it just needs to be **invited again**!
      `)
      .setImage(`https://cdn.discordapp.com/attachments/969930430239342594/993927455750508696/helpMessageCreate.png`)
    message.reply({
      content: `HI`
    })
  }

});